{% extends 'base.html' %}

{% block title %}Set New Password - Health Monitoring{% endblock %}
{% block body_class %}auth-page{% endblock %}

{% block content %}
<div class="auth-shell">
    <div class="auth-card card">
        <div class="auth-logo" aria-hidden="true">
            <i class="fa-solid fa-lock"></i>
        </div>
        <div class="mb-4 text-center auth-header">
            <h1 class="h3 mb-2">Set a new password</h1>
            <div class="text-muted">Choose a strong password to secure your account.</div>
        </div>
        {% if validlink %}
        <form method="post" class="auth-form">
            {% csrf_token %}
            {% if form.non_field_errors %}
            <div class="alert-custom alert-warning">Please review the errors below.</div>
            {% endif %}
            <div class="mb-3">
                <label for="id_new_password1" class="form-label">New password</label>
                <input type="password" name="new_password1" id="id_new_password1" class="form-control{% if form.new_password1.errors %} is-invalid{% endif %}" autocomplete="new-password" required{% if form.new_password1.errors %} aria-describedby="new-password1-error"{% endif %}>
                {% if form.new_password1.errors %}
                <div id="new-password1-error" class="form-error">
                    {% for error in form.new_password1.errors %}{{ error }}{% endfor %}
                </div>
                {% endif %}
            </div>
            <div class="mb-3">
                <label for="id_new_password2" class="form-label">Confirm password</label>
                <input type="password" name="new_password2" id="id_new_password2" class="form-control{% if form.new_password2.errors %} is-invalid{% endif %}" autocomplete="new-password" required{% if form.new_password2.errors %} aria-describedby="new-password2-error"{% endif %}>
                {% if form.new_password2.errors %}
                <div id="new-password2-error" class="form-error">
                    {% for error in form.new_password2.errors %}{{ error }}{% endfor %}
                </div>
                {% endif %}
            </div>
            <button type="submit" class="btn btn-primary w-100 auth-submit">Set password</button>
        </form>
        {% else %}
        <div class="text-center">
            <div class="text-muted mb-3">This reset link is invalid or has expired.</div>
            <a href="{% url 'health:password_reset' %}" class="auth-link">Request a new link</a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
